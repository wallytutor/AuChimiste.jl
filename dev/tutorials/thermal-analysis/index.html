<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Thermal analysis simulation · AuChimiste.jl</title><meta name="title" content="Thermal analysis simulation · AuChimiste.jl"/><meta property="og:title" content="Thermal analysis simulation · AuChimiste.jl"/><meta property="twitter:title" content="Thermal analysis simulation · AuChimiste.jl"/><meta name="description" content="Documentation for AuChimiste.jl."/><meta property="og:description" content="Documentation for AuChimiste.jl."/><meta property="twitter:description" content="Documentation for AuChimiste.jl."/><meta property="og:url" content="https://wallytutor.github.io/AuChimiste.jl/tutorials/thermal-analysis/"/><meta property="twitter:url" content="https://wallytutor.github.io/AuChimiste.jl/tutorials/thermal-analysis/"/><link rel="canonical" href="https://wallytutor.github.io/AuChimiste.jl/tutorials/thermal-analysis/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">AuChimiste.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">AuChimiste Toolbox</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../basics/elements/">Elements</a></li><li><a class="tocitem" href="../../basics/components/">Components</a></li><li><a class="tocitem" href="../../basics/thermodynamics/">Thermodynamics</a></li><li><a class="tocitem" href="../../basics/kinetics/">Kinetics</a></li><li><a class="tocitem" href="../../basics/hardcoded/">Hardcoded</a></li><li><a class="tocitem" href="../../basics/drummers/">Drummers</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Thermal analysis simulation</a><ul class="internal"><li><a class="tocitem" href="#Species-properties"><span>Species properties</span></a></li><li><a class="tocitem" href="#Global-mechanism"><span>Global mechanism</span></a></li><li><a class="tocitem" href="#Reaction-kinetics"><span>Reaction kinetics</span></a></li><li><a class="tocitem" href="#Experimental-controls"><span>Experimental controls</span></a></li><li><a class="tocitem" href="#Model-statement"><span>Model statement</span></a></li><li><a class="tocitem" href="#Sensitivity-study"><span>Sensitivity study</span></a></li></ul></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/users/">Users</a></li><li><a class="tocitem" href="../../manual/kinetics/">Kinetics</a></li><li><a class="tocitem" href="../../manual/drummers/">Drummers</a></li><li><a class="tocitem" href="../../manual/development/">Development</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Thermal analysis simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Thermal analysis simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/wallytutor/AuChimiste.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/wallytutor/AuChimiste.jl/blob/main/docs/src/tutorials/thermal-analysis.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Thermal-analysis-simulation"><a class="docs-heading-anchor" href="#Thermal-analysis-simulation">Thermal analysis simulation</a><a id="Thermal-analysis-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Thermal-analysis-simulation" title="Permalink"></a></h1><div class="admonition is-danger"><header class="admonition-header">Under development</header><div class="admonition-body"><p>This is a placeholder! Please, hold tight while the cook works!</p></div></div><p>In this note we investigate the right implementation to reproduce the kinetics of kaolinite calcination reported by Eskelinen <em>et al.</em> [<a href="../../references/#Eskelinen2015">5</a>]. Neither their model nor their references properly provide the concentration units used in the rate laws, so that becomes an issue when trying to reproduce the results. Here we derive the equations for a complete mass and energy balance to simulate a coupled DSC/TGA analysis of the material in with different concentration units in the rate laws.</p><pre><code class="language-julia hljs">using AuChimiste
using LinearAlgebra
using ModelingToolkit</code></pre><h2 id="Species-properties"><a class="docs-heading-anchor" href="#Species-properties">Species properties</a><a id="Species-properties-1"></a><a class="docs-heading-anchor-permalink" href="#Species-properties" title="Permalink"></a></h2><p>In what follows the condensate species will be indexed as the next list, so for simplifying notation species will be referred to solely by their index.</p><ol><li>Liquid water</li><li>Kaolinite <span>$Al_2Si_2O_5(OH)_4$</span></li><li>Metakaolin <span>$Al_2Si_2O_7$</span></li><li><em>Spinel</em> <span>$Al_4Si_3O_{12}$</span></li><li>Amorphous silica <span>$SiO_2$</span></li></ol><p>Final conversion of spinel into mullite and cristobalite is neglected here.</p><p>Polynomials for specific heat are those of Schieltz and Soliman [<a href="../../references/#Schieltz1964">6</a>], except for <em>spinel</em> phase for which at the time of the publication was unknown. A rough estimate of its value is provided by Eskelinen <em>et al.</em> [<a href="../../references/#Eskelinen2015">5</a>]. Since this phase is the least relevant in the present study and the  order of magnitude seems correct, it is employed in the simulations.</p><p>Below we start by loading the database and displaying the species table:</p><h2 id="Global-mechanism"><a class="docs-heading-anchor" href="#Global-mechanism">Global mechanism</a><a id="Global-mechanism-1"></a><a class="docs-heading-anchor-permalink" href="#Global-mechanism" title="Permalink"></a></h2><p>Here we provide the mechanism discussed by Eskelinen <em>et al.</em> [<a href="../../references/#Eskelinen2015">5</a>]. Individual reaction steps are better described by Holm [<a href="../../references/#Holm2001">7</a>], especially beyond our scope at high temperatures.</p><p class="math-container">\[\begin{aligned}
H_2O_{(l)} &amp;\rightarrow H_2O_{(g)} &amp; \Delta{}H&gt;0\\
Al_2Si_2O_5(OH)_4 &amp;\rightarrow Al_2Si_2O_7 + 2H_2O_{(g)} &amp; \Delta{}H&gt;0\\
2Al_2Si_2O_7 &amp;\rightarrow Al_4Si_3O_{12} + {SiO_2}_{(a)} &amp; \Delta{}H&lt;0
\end{aligned}\]</p><p>Be <span>$r_{i}$</span> the rate of the above reactions in molar units, <em>i.e.</em> <span>$mol\cdotp{}s^{-1}$</span>, then the rate of production of each of the considered species in solid state is given as:</p><p class="math-container">\[\begin{pmatrix}
\dot{\omega}_1\\
\dot{\omega}_2\\
\dot{\omega}_3\\
\dot{\omega}_4\\
\dot{\omega}_5\\
\end{pmatrix}
=
\begin{pmatrix}
 -1 &amp;  0 &amp;  0\\
  0 &amp; -1 &amp;  0\\
  0 &amp;  1 &amp; -2\\
  0 &amp;  0 &amp;  1\\
  0 &amp;  0 &amp;  1\\
\end{pmatrix}
\begin{pmatrix}
r_1\\
r_2\\
r_3\\
\end{pmatrix}\]</p><p>In matrix notation one can write <span>$\dot{\omega}=\nu\cdotp{}r$</span>, as it will be implemented. By multiplying each element of the resulting array by its molecular mass we get the net production rates in mass units. Constant <span>$\nu$</span> provides the required coefficients matrix.</p><p>Mass loss through evaporation and dehydroxylation is handled separately because it becomes simpler to evaluate the condensate phases specific heat in a later stage. The first two reactions release water to the gas phase, so <span>$\eta$</span> below provides the stoichiometry for this processes.</p><p>Sample mass loss is then simply <span>$\dot{m}=\eta\cdotp{}rM_1$</span>, where <span>$M_1$</span> is water molecular mass so that the expression is given in <span>$kg\cdotp{}s^{-1}$</span>.</p><pre><code class="language-julia hljs">&quot;Species net production rate [kg/s]&quot;
function net_production_rates(data::ThermalAnalysisData, r)
    ν = [-1  0  0;  # WATER_L
          0 -1  0;  # KAOLINITE
          0  1 -2;  # METAKAOLIN
          0  0  1;  # SIO2_GLASS
          0  0  1]  # SPINEL
    return diagm(data.sample.molar_masses) * (ν * r)
end
nothing; # hide</code></pre><pre><code class="language-julia hljs">&quot;Sample mass loss rate [kg/s]&quot;
function mass_loss_rate(data::ThermalAnalysisData, r)
    return [-1data.losses.molar_masses[1] * (r[1] + 2r[2])]
end
nothing; # hide</code></pre><h2 id="Reaction-kinetics"><a class="docs-heading-anchor" href="#Reaction-kinetics">Reaction kinetics</a><a id="Reaction-kinetics-1"></a><a class="docs-heading-anchor-permalink" href="#Reaction-kinetics" title="Permalink"></a></h2><p>Eskelinen <em>et al.</em> [<a href="../../references/#Eskelinen2015">5</a>] compile a set of pre-exponential factors and activation energies for <em>Arrhenius</em> rate constants for the above reactions, which are provided in <code>A</code> and <code>Eₐ</code> below. Their reported reaction enthalpies are given in <span>$ΔH$</span>.</p><p>For such a global approach we do not have the privilege of working with actual concentrations because the mass distribution in the system is unknown and it would be meaningless to work with specific masses. Thus, assume the reaction rates are proportional to the number of moles of the reacting species <span>$n_r$</span> so we get the required units as exposed above. Then the <span>$r_i$</span> can be expressed as</p><p class="math-container">\[r_{i} = k_i(T)n_r=k_i(T)\frac{m_r}{M_r}=k_i(T)\frac{Y_r}{M_r}m\]</p><pre><code class="language-julia hljs">&quot;Compute reaction rates [mol/s].&quot;
function reaction_rates(data::ThermalAnalysisData, m, T, Y)
    # A: rate constant pre-exponential factor [1/s].
    # E: reaction rate activtation energies [J/(mol.K)].
    A = [5.0000e+07; 1.0000e+07; 5.0000e+33]
    E = [61.0; 145.0; 856.0] * 1000.0

    k = A .* exp.(-E ./ (GAS_CONSTANT * T))
    n = m .* Y[1:3] ./ data.sample.molar_masses[1:3]
    
    return k .* n
end
nothing; # hide</code></pre><pre><code class="language-julia hljs">&quot;Total heat release rate for reactions [W].&quot;
function heat_release_rate(data::ThermalAnalysisData, r, T)
    # Reaction enthalpies per unit mass of reactant [J/kg].
    # ΔH = [2.2582e+06; 8.9100e+05; -2.1290e+05]

    h2o_l, kaolinite, metakaolin, sio2, spinel = data.sample.species
    h2o_g = data.losses.species[1]

    # Already computed in [J/mol]!!!
    ΔH = [enthalpy_evaporation(T, h2o_l, h2o_g); 
          enthalpy_dehydration(T, kaolinite, metakaolin, h2o_g);
          enthalpy_decomposition(T, metakaolin, sio2, spinel)] 

    return r&#39; * ΔH
end
nothing; # hide</code></pre><pre><code class="language-julia hljs">function enthalpy_evaporation(T, h2o_l, h2o_g)
    rp = AuChimiste.enthalpy_hess(h2o_g, T)
    rr = AuChimiste.enthalpy_hess(h2o_l, T)
    return rp - rr
end

function enthalpy_dehydration(T, kaolinite, metakaolin, h2o_g)
    rp = 1.0AuChimiste.enthalpy_hess(metakaolin, T)
    rp += 2.0AuChimiste.enthalpy_hess(h2o_g, T)
    rr = AuChimiste.enthalpy_hess(kaolinite, T)
    return rp - rr
end

function enthalpy_decomposition(T, metakaolin, sio2, spinel)
    # rp = 0.5AuChimiste.enthalpy_hess(sio2, T)
    # rp += 0.5AuChimiste.enthalpy_hess(spinel, T)
    # rr = AuChimiste.enthalpy_hess(metakaolin, T)
    # return rp - rr
    # TODO: fix spinel Hf to use the above.
    return 0.22212607680000002 * -2.1290e+05
end
nothing; # hide</code></pre><h2 id="Experimental-controls"><a class="docs-heading-anchor" href="#Experimental-controls">Experimental controls</a><a id="Experimental-controls-1"></a><a class="docs-heading-anchor-permalink" href="#Experimental-controls" title="Permalink"></a></h2><p>To wrap-up we provide the programmed thermal cycle and the computation of required heat input to produce a perfect heating curve. It must be emphasized that actual DSC machines use some sort of controllers to reach this, what introduces one source of stochastic behavior to the measurement.</p><h2 id="Model-statement"><a class="docs-heading-anchor" href="#Model-statement">Model statement</a><a id="Model-statement-1"></a><a class="docs-heading-anchor-permalink" href="#Model-statement" title="Permalink"></a></h2><p>Below we put together everything that has been developed above.</p><p>There are a few different types of quantities here:</p><ul><li>Independent variables, here only `<span>$t$</span></li><li>Dependent variables, <span>$m$</span> and <span>$Y$</span></li><li>Observable derivatives <span>$ṁ$</span> and <span>$Ẏ$</span></li><li>Other observables (partial calculations)</li></ul><p>Because of how a DSC analysis is conducted, it was chosen that the only model parameter should be the heating rate <span>$θ̇$</span>. Furthermore, all other quantities were encoded in the developed functions.</p><pre><code class="language-julia hljs">data = ThermalAnalysisData(;
    selected_species = [
        &quot;WATER_L&quot;,
        &quot;KAOLINITE&quot;,
        &quot;METAKAOLIN&quot;,
        &quot;SIO2_GLASS&quot;,
        &quot;SPINEL&quot;,
    ],
    released_species = [&quot;WATER_G&quot;],
    n_reactions = 3,
    reaction_rates       = reaction_rates,
    net_production_rates = net_production_rates,
    mass_loss_rate       = mass_loss_rate,
    heat_release_rate    = heat_release_rate,
)

@info(typeof(data))
@info(species_table(data.sample.db))</code></pre><pre><code class="language-julia hljs">data.sample.molar_masses[3]</code></pre><pre><code class="language-julia hljs"># Analysis heating rate.
Θ = 20.0

# Integration interval to simulate problem.
T_ini = 300.0
T_end = 300 + 1175

# Initial mass.
m = 16.0e-06

# Initial composition of the system.
y0 = [0.005, 0.995, 0.0, 0.0, 0.0]

# Interval of simulation.
τ = (T_end - T_ini) * 60 / Θ

program_temperature = LinearProgramTemperature(T_ini, Θ)

model = ThermalAnalysisModel(; data, program_temperature = (t)-&gt;program_temperature(t))

sol = solve(model, τ, m, y0)
nothing; # hide</code></pre><pre><code class="language-julia hljs">df = tabulate(model, sol)
names(df)</code></pre><p>Now we can get the actual <code>equations</code>:</p><pre><code class="language-julia hljs">equations(model.ode)</code></pre><pre><code class="language-julia hljs">unknowns(model.ode)</code></pre><p>... and the <code>observed</code> quantities.</p><pre><code class="language-julia hljs"># observed(model.ode)</code></pre><pre><code class="language-julia hljs">let
    fig, ax, lx = AuChimiste.plot(model, sol; xticks = T_ini:100:T_end)
    # axislegend(ax[1]; position = :rt, orientation = :horizontal, nbanks=3)
    # axislegend(ax[3]; position = :rt, orientation = :vertical)

    # ax[1].yticks = 0:20:80
    # ax[2].yticks = 70:5:100
    # ax[3].yticks = 0:0.1:0.7
    # ax[5].yticks = 0:0.5:3.5
    # ax[6].yticks = 0.9:0.05:1.25

    # ylims!(ax[1], (-1, 80))
    # ylims!(ax[2], (70, 100))
    # ylims!(ax[3], (-0.01, 0.7))
    # ylims!(ax[4], (0, 4.5))
    # ylims!(ax[5], (0, 3.5))
    # ylims!(ax[6], (0.9, 1.25))

    fig
end</code></pre><h2 id="Sensitivity-study"><a class="docs-heading-anchor" href="#Sensitivity-study">Sensitivity study</a><a id="Sensitivity-study-1"></a><a class="docs-heading-anchor-permalink" href="#Sensitivity-study" title="Permalink"></a></h2><p>Now it is time to play and perform a numerical experiment.</p><p>This will insights about the effects of some parameters over the expected results.</p><p>Use the variables below to select the value of:</p><p>An advantage of using observables in the model is the post-processing capactities it offers. All observables are stored in memory together with problem solution. If expected solution is too large, it is important to really think about what should be included as an observable for memory reasons.</p><p>Below we illustrate the mixture specific heat extracted from the observables.</p><p>Hope these notes provided you insights on DSC/TGA methods!</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../basics/drummers/">« Drummers</a><a class="docs-footer-nextpage" href="../../manual/users/">Users »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Saturday 19 April 2025 18:31">Saturday 19 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
